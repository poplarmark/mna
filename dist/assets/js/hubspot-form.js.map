{"version":3,"file":"hubspot-form.js","names":["$","each","i","this","find","val","submit","e","preventDefault","parsedFormData","FormData","target","entries","map","dataObject","name","value","goToWebinarWebinarKey","input","sfdcCampaignId","hutk","document","cookie","replace","undefined","console","log","processingPrompt","communicationConsent","filter","item","includes","element","label","attr","checked","text","subscriptionTypeId","parseInt","split","ignoredFields","data","fields","ignoredField","context","pageUri","window","location","href","pageName","title","goToWebinarKey","legalConsentOptions","consent","consentToProcess","communications","final_data","JSON","stringify","ajax","url","action","type","dataType","contentType","accept","success","response","inlineMessage","parent","children","show","error","css","siblings"],"sources":["hubspot-form.js"],"mappings":"AAAAA,EAAE,2CAA2CC,MAAK,SAAUC,GAE1DF,EAAEG,MAAMC,KAAK,wBAAwBC,IAAI,QACzCL,EAAEG,MAAMG,QAAO,SAAUC,GAEvBA,EAAEC,iBACF,MACMC,EAAiB,IADN,IAAIC,SAASH,EAAEI,QACIC,WAAWC,KAAKC,IAAe,CAEjEC,KAAMD,EAAW,GACjBE,MAAOF,EAAW,OAEdG,EAAwBR,EAAeL,MAC1Cc,GAAyB,0BAAfA,EAAMH,QAChBC,MACGG,EAAiBV,EAAeL,MACnCc,GAAyB,mBAAfA,EAAMH,QAChBC,MACGI,EACJC,SAASC,OAAOC,QACd,oDACA,YACGC,EACPC,QAAQC,IAAIN,GACZ,MAAMO,EAAmB3B,EAAEG,MAAMC,KAAK,kCAChCwB,EAAuBnB,EAC1BoB,QAAQC,GAASA,EAAKf,KAAKgB,SAAS,mBACpClB,KAAKiB,IAEJ,MAAME,EAAUhC,EACd,IAAI8B,EAAKf,KAAKQ,QAAQ,sBAAuB,WAC7C,GACIU,EAAQjC,EACZ,aACEA,EAAEgC,GACCE,KAAK,MACLX,QAAQ,sBAAuB,QAClC,MAEJ,MAAO,CACLP,MAAOgB,EAAQG,QACfC,KAAMH,EAAMG,OACZC,mBAAoBC,SAClBR,EAAKf,KAAKwB,MAAM,oCAAoC,IAEvD,IAECC,EAAgB,CACpB,SACA,YACA,OACA,gBACA,wBACA,kBAEIC,EAAO,CAEXC,OAAQjC,EAAeoB,QACpBC,IACEU,EAAcpC,MAAMuC,GACnBb,EAAKf,KAAKgB,SAASY,OAGzBC,QAAS,CACPC,QAASC,OAAOC,SAASC,KACzBC,SAAU5B,SAAS6B,MACnB/B,eAAgBA,EAChBgC,eAAgBlC,EAChBG,KAAMA,MAEHO,EAED,CACEyB,oBAAqB,CACnBC,QAAS,IACF1B,EAED,CACE2B,kBAAkB,EAClBlB,KAAMT,EAAiBS,QAHzB,CAAC,KAKAR,EAED,CACE2B,eAAgB3B,GAFlB,CAAC,KAXX,CAAC,GAmBD4B,EAAaC,KAAKC,UAAUjB,GAClCzC,EAAE2D,KAAK,CACLC,IAAKrD,EAAEI,OAAOkD,OACdC,KAAM,OACNC,SAAU,OACVtB,KAAMe,EACNQ,YAAa,iCACbC,OAAQ,mBACRC,QAAS,SAAUC,GACjB,GAAIA,GACEA,EAASC,cAAe,CACXpE,EAAEO,EAAEI,QAAQ0D,SAEpBC,SAAS,gBAAgBC,MAClC,CAEJ,EACAC,MAAO,WACH/C,QAAQC,IAAI,gCACZ1B,EAAEO,EAAEI,QAAQ8D,IAAI,UAAW,QAAQC,SAAS,gBAAgBH,MAChE,GAEJ,GACF","sourcesContent":["$('form[action^=\"https://api.hsforms.com\"]').each(function (i) {\n  // intercept forms whos action goes to hubspot\n  $(this).find(\"input[type=checkbox]\").val(\"true\");\n  $(this).submit(function (e) {\n    // when the form submits\n    e.preventDefault(); //stop the form from submitting to webflow\n    const formData = new FormData(e.target); // get the form data\n    const parsedFormData = [...formData.entries()].map((dataObject) => ({\n      // convert data to array\n      name: dataObject[0], // make sure the name of the input is the same as the hubspot input name\n      value: dataObject[1], // the value of the input\n    }));\n    const goToWebinarWebinarKey = parsedFormData.find(\n      (input) => input.name === \"goToWebinarWebinarKey\"\n    )?.value; // looks for an input with the name goToWebinarWebinarKey\n    const sfdcCampaignId = parsedFormData.find(\n      (input) => input.name === \"sfdcCampaignId\"\n    )?.value; // looks for an input with the name sfdcCampaignId\n    const hutk =\n      document.cookie.replace(\n        /(?:(?:^|.*;\\s*)hubspotutk\\s*\\=\\s*([^;]*).*$)|^.*$/,\n        \"$1\"\n      ) || undefined; // looks for an input with the name hutk, the hubspot user token\n    console.log(hutk);\n    const processingPrompt = $(this).find(\"[id*='gdpr-processing-prompt']\"); // looks for an element with the id gdpr-processing-prompt\n    const communicationConsent = parsedFormData\n      .filter((item) => item.name.includes(\"LEGAL_CONSENT\"))\n      .map((item) => {\n        // finds LEGAL_CONSENT options and stores them\n        const element = $(\n          `#${item.name.replace(/(:|\\.|\\[|\\]|,|=|@)/g, \"\\\\$1\")}`\n        )[0]; // checks if they've checked the checkbox to consent\n        const label = $(\n          \"span[for='\" +\n            $(element)\n              .attr(\"id\")\n              .replace(/(:|\\.|\\[|\\]|,|=|@)/g, \"\\\\$1\") +\n            \"']\"\n        ); // gets the label of the checkbox\n        return {\n          value: element.checked,\n          text: label.text(),\n          subscriptionTypeId: parseInt(\n            item.name.split(\"LEGAL_CONSENT.subscription_type_\")[1]\n          ), // the subscription the user is consenting to\n        };\n      });\n    const ignoredFields = [\n      \"cc-num\",\n      \"cc-number\",\n      \"gdpr\",\n      \"LEGAL_CONSENT\",\n      \"goToWebinarWebinarKey\",\n      \"sfdcCampaignId\",\n    ];\n    const data = {\n      // the data we send to hubspot\n      fields: parsedFormData.filter(\n        (item) =>\n          !ignoredFields.find((ignoredField) =>\n            item.name.includes(ignoredField)\n          )\n      ), // set the form data but ignore certain fields\n      context: {\n        pageUri: window.location.href, // log the current url\n        pageName: document.title, // log the pages title\n        sfdcCampaignId: sfdcCampaignId, // salesforce campaign id\n        goToWebinarKey: goToWebinarWebinarKey, // go to meeting key\n        hutk: hutk, // hubspot user token\n      },\n      ...(!processingPrompt\n        ? {}\n        : {\n            legalConsentOptions: {\n              consent: {\n                ...(!processingPrompt\n                  ? {}\n                  : {\n                      consentToProcess: true,\n                      text: processingPrompt.text(),\n                    }),\n                ...(!communicationConsent\n                  ? {}\n                  : {\n                      communications: communicationConsent,\n                    }),\n              },\n            },\n          }),\n    };\n    const final_data = JSON.stringify(data); // turn that javascript object into a json string\n    $.ajax({\n      url: e.target.action,\n      type: \"POST\",\n      dataType: \"json\",\n      data: final_data,\n      contentType: \"application/json;charset=utf-8\",\n      accept: \"application/json\",\n      success: function (response) {\n        if (response) {\n          if (response.inlineMessage) {\n            const parent = $(e.target).parent();\n            // parent.children(\"form\").css(\"display\", \"none\") // hide form\n            parent.children(\".w-form-done\").show(); // replace .w-form-done with your own form done section\n          }\n        }\n      },\n      error: function () {\n          console.log(\"error on the form submission\")\n          $(e.target).css('display', 'none').siblings('.w-form-fail').show() // replace .w-form-fail with your own form done section\n      }\n    });\n  });\n});"]}